<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Building Blocks - 4&nbsp; Summarizing Distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rn.html" rel="next">
<link href="./prob-random-vars.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summarizing Distributions</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Building Blocks</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">Probability</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-counting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Counting Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-random-vars.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sum-dist.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summarizing Distributions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./rn.html" class="sidebar-item-text sidebar-link">Generating Random Numbers</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rn-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rn-integration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rn-mcmc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">MCMC</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./cm.html" class="sidebar-item-text sidebar-link">Correlation Matrices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cm-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cm-nhst.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Null Hypothesis Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cm-modeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cm-visualizing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#expectation" id="toc-expectation" class="nav-link active" data-scroll-target="#expectation"><span class="toc-section-number">4.1</span>  Expectation</a></li>
  <li><a href="#moments-and-variances" id="toc-moments-and-variances" class="nav-link" data-scroll-target="#moments-and-variances"><span class="toc-section-number">4.2</span>  Moments and variances</a></li>
  <li><a href="#mean-squared-error" id="toc-mean-squared-error" class="nav-link" data-scroll-target="#mean-squared-error"><span class="toc-section-number">4.3</span>  Mean Squared Error</a></li>
  <li><a href="#summarizing-joint-distributions" id="toc-summarizing-joint-distributions" class="nav-link" data-scroll-target="#summarizing-joint-distributions"><span class="toc-section-number">5</span>  Summarizing joint distributions</a>
  <ul class="collapse">
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance"><span class="toc-section-number">5.1</span>  Covariance</a></li>
  <li><a href="#conditional-expectations" id="toc-conditional-expectations" class="nav-link" data-scroll-target="#conditional-expectations"><span class="toc-section-number">5.2</span>  Conditional Expectations</a></li>
  <li><a href="#best-predictors" id="toc-best-predictors" class="nav-link" data-scroll-target="#best-predictors"><span class="toc-section-number">5.3</span>  Best Predictors</a></li>
  <li><a href="#properties-of-residuals" id="toc-properties-of-residuals" class="nav-link" data-scroll-target="#properties-of-residuals"><span class="toc-section-number">5.4</span>  Properties of residuals</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summarizing Distributions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="expectation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="expectation"><span class="header-section-number">4.1</span> Expectation</h2>
<p>The expected value (also known as the <em>expectation</em> or <em>mean</em>) is the most common measure of the “center” of a probability distribution.</p>
<ul>
<li>Discrete random variables</li>
</ul>
<p><span class="math display">\[
E[X] = \sum_{\textsf{supp}(x)} x f(x)
\]</span></p>
<ul>
<li>Continuous random variables</li>
</ul>
<p><span class="math display">\[
E[X] = \int_{-\infty}^\infty x f(x)dx
\]</span></p>
<ul>
<li><strong>Properties of expected values</strong></li>
</ul>
<p><span class="math display">\[
\begin{align}
&amp;E[c] = c &amp;\text{ for all } c \in \mathbb R \\\\
&amp;E[cX] = c\ E[X]  &amp;\text{ for all } c \in \mathbb R
\end{align}
\]</span></p>
<ul>
<li>Expectation of a Bernoulli random variable</li>
</ul>
<p><span class="math display">\[
E[X] = P(X = 1) = p
\]</span></p>
<p><strong>Expectation of a function of a random variable</strong> (also known as <em>LOTUS</em>). This comes up in many applications (e.g.&nbsp;finding the <em>variance</em> of a random variable), but the result is far from obvious (see <a href="#lotus">here</a>).</p>
<ul>
<li>Continuous case</li>
</ul>
<p><span class="math display">\[E[g(X)] = \int_{-\infty}^\infty g(x) f_X(x) dx\]</span></p>
<ul>
<li>Discrete case</li>
</ul>
<p><span class="math display">\[E[g(X)] = \sum_{\textsf{supp}(x)} g(x) f_X(x)\]</span></p>
<ul>
<li><strong>Linearity of expectations</strong></li>
</ul>
<p><span class="math display">\[E[aX + bY + c] = aE[X] + bE[Y] + c\]</span></p>
<p>Note that this property follows from considering the expectation of a function of a bivariate joint distribution.</p>
<p><span class="math display">\[\underbrace{g(X, Y) = aX + bY + c}_\text{function of a bivariate joint distribution}\]</span></p>
<p>Apply <em>LOTUS</em> and <em>marginalization</em>:</p>
<p><span class="math display">\[
\begin{align}
E[g(X, Y)] &amp;= \sum_x \sum_y g(X, Y) f_{XY}(x,y) \\\\ &amp;=
\sum_x \sum_y (ax + by + c) f_{XY}(x,y) \\\\ &amp;=
a\sum_x \sum_y x f_{XY}(x,y) +  b\sum_x \sum_y y f_{XY}(x,y)+ c\sum_x \sum_y f_{XY}(x,y)
\end{align}
\]</span></p>
</section>
<section id="moments-and-variances" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="moments-and-variances"><span class="header-section-number">4.2</span> Moments and variances</h2>
<p>We can generalize expectations to further characterize the features of a distribution. This is the idea of <strong>raw moments</strong>, among which the expected value is just a special case.</p>
<p><span class="math display">\[
\underbrace{\mu_j^\prime = E[X^j]}_{j^{th}\text{ raw moment }}
\]</span></p>
<p>Raw moments provide summary information about a distribution, describing elements of its <em>shape</em> and <em>location</em>.</p>
<ul>
<li><strong>Central moments</strong></li>
</ul>
<p><span class="math display">\[\mu_j = E\left[(X - E[X])^j\right]\]</span></p>
<p>The sole distinction between raw and central moments lies in whether or not the expected value of <span class="math inline">\(X\)</span> is subtracted before calculations.</p>
<ul>
<li>The <strong>variance</strong> (second central moment)</li>
</ul>
<p><span class="math display">\[
V[X] = E\left[(X - E[X])^2\right] = E\left[X^2\right] - E[X]^2
\]</span></p>
<p>The variance measures the expected value of the squared difference between the observed value of <span class="math inline">\(X\)</span> and its mean. Note that the first central moment equals zero.</p>
<ul>
<li><strong>Properties of variances</strong></li>
</ul>
<p><span class="math display">\[
\begin{align}
&amp;V[X + c] = V[X] &amp;\text{ for all } c \in \mathbb R \\\\
&amp;V[cX] = c^2\ E[X]  &amp;\text{ for all } c \in \mathbb R
\end{align}
\]</span></p>
<ul>
<li><strong>Standard deviation</strong></li>
</ul>
<p><span class="math display">\[
\sigma[X] = \sqrt{V[X]}
\]</span></p>
<p>The standard deviation is often preferable to the variance, since it is on the same scale as the random variable of interest.</p>
<p>Knowing these two quantities (<span class="math inline">\(E[X]\)</span> and <span class="math inline">\(\sigma[X]\)</span>) tells <em>everything</em> about normal distributions.</p>
<ul>
<li><strong>The normal distribution</strong></li>
</ul>
<p><span class="math display">\[X \sim \textsf{normal}(\mu, \sigma)\]</span></p>
<p><span class="math display">\[
E[X] = \mu \hspace{0.5cm} \text{ and } \hspace{0.5cm}
\sigma[X] = \sigma
\]</span></p>
<p><span class="math display">\[
f_X(x) = \frac{1}{\sigma \sqrt{2 \pi}} \exp\left(-\frac{1}{2 \sigma^2} (x - \mu)^2\right)
\]</span></p>
<p>Any linear combination of any number of mutually independent normal random variables must itself be normal.</p>
<p><span class="math display">\[
X \perp Y \to X + Y \sim \textsf{normal}\left(\mu_X + \mu_Y, \sqrt{\sigma_X^2 + \sigma_Y^2}\right)
\]</span></p>
</section>
<section id="mean-squared-error" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="mean-squared-error"><span class="header-section-number">4.3</span> Mean Squared Error</h2>
<p>MSE is a metric that characterizes how well a random variable <span class="math inline">\(X\)</span> approximates a certain value <span class="math inline">\(c\)</span>.</p>
<p><span class="math display">\[MSE = E\left[(X - c)^2\right]\]</span></p>
<p>Note that the MSE about zero is the same as the <em>second raw moment</em>, and the MSE about <span class="math inline">\(E[X]\)</span> is the same as the <em>second central moment</em>, which is also the variance.</p>
<ul>
<li><p><strong>Root Mean Squared Error</strong></p>
<p><span class="math display">\[\sqrt{E\left[(X - c)^2\right]}\]</span></p>
<p>Note. This is used as a common measure of accuracy in the context of estimation.</p></li>
<li><p><strong>Decomposition</strong></p></li>
</ul>
<p><span class="math display">\[
\begin{align}
E\left[(X - c)^2\right] &amp;= E\left[(X^2 - 2cX + c^2\right] \\\\ &amp;=
E\left[X^2\right] - 2cE[X] + c^2 \\\\ &amp;=
E\left[X^2\right] \underbrace{- E[X]^2 + E[X]^2}_\text{clever trick} - 2cE[X] + c^2 \\\\ &amp;=
\left(E\left[X^2\right] - E[X]^2\right) + \left(E[X]^2 - 2cE[X] + c^2\right) \\\\ &amp;=
V[X] + (E[X]-c)^2
\end{align}
\]</span></p>
<p><strong>Note.</strong> In the context of estimation, this is also known as the <em>bias-variance decomposition</em>.</p>
<p>The MSE is also linked to an alternative definition of the mean: the value <span class="math inline">\(c\)</span> that minimizes the MSE of <span class="math inline">\(X\)</span> is <span class="math inline">\(E[X]\)</span>.</p>
<p><span class="math display">\[
\underset{c \in \mathbb R}{\arg \min}\ E\left[(X - c)^2\right] = E[X]
\]</span></p>
<p>If we where to choose a different “loss function” besides the MSE, we could come up with different “best” choices for <span class="math inline">\(c\)</span>. For example, the <em>median</em> is the value <span class="math inline">\(c\)</span> that minimizes the Mean Absolute Error (<span class="math inline">\(|X - c|\)</span>).</p>
</section>
<section id="summarizing-joint-distributions" class="level1 page-columns page-full" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Summarizing joint distributions</h1>
<section id="covariance" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="covariance"><span class="header-section-number">5.1</span> Covariance</h2>
<p>Covariance measures the extent to which two random variables “move together.”</p>
<p><span class="math display">\[
\begin{align}
\text{Cov}[X, Y] &amp;= E\big[(X - E[X])(Y - E[Y])\big] \\\\ &amp;=
E[XY] - E[X]E[Y]
\end{align}
\]</span></p>
<ul>
<li><strong>Variance Rule</strong> (non-linearity of variances)</li>
</ul>
<p><span class="math display">\[V[X + Y] = V[X] + 2\text{Cov}[X, Y] + V[Y]\]</span></p>
<ul>
<li><strong>Variance is a special case of Covariance</strong></li>
</ul>
<p><span class="math display">\[\text{Cov}[X, X] = V[X]\]</span></p>
<ul>
<li><strong>Covariance of sums</strong></li>
</ul>
<p><span class="math display">\[
\text{Cov}[X + W, Y + Z] = \text{Cov}[X, Y] + \text{Cov}[X, Z] + \text{Cov}[W, Y] + \text{Cov}[W, Z]
\]</span></p>
<p>Much like standard deviation rescales variance, correlation rescales covariance to make its interpretation clearer. The <strong>correlation</strong> of two random variables is as follows:</p>
<p><span class="math display">\[
\rho[X, Y] = \frac{\text{Cov}[X, Y]}{\sigma[X] \sigma[Y]}
\]</span></p>
<p>The correlation <span class="math inline">\(\rho\)</span> is bounded in <span class="math inline">\([-1, 1]\)</span>, a fact that derives from the <em>Cauchy-Schwarz inequality</em>.</p>
<p><strong>Linear dependence</strong> describes the relationship between two random variables where one can be written as a linear function of the other. And correlation measures the degree of linear dependence between two random variables.</p>
<p><span class="math display">\[
\begin{align}
&amp;\rho[X, Y] = 1 \iff Y = a + bX \\\\
&amp;\rho[X, Y] = -1 \iff Y = a - bX \\\\
&amp;\text{where } b &gt; 0 \text{ and } a,b \in \mathbb R
\end{align}
\]</span></p>
<p>If two random variables are <em>linearly</em> independent, then <span class="math inline">\(\text{Cov}[X, Y] = 0\)</span>. This fact follows from the definition of covariance and the application of LOTUS.</p>
<p><span class="math display">\[
\begin{align}
E[XY] &amp;= \int_{-\infty}^\infty \int_{-\infty}^\infty x y f(x, y)dydx \\\\ &amp;=
\int_{-\infty}^\infty \int_{-\infty}^\infty xy f_X(x)f_Y(y)dydx \\\\ &amp;=
\int_{-\infty}^\infty x f_X(x)dx \int_{-\infty}^\infty y f_Y(y) \\\\ &amp;=
E[X]E[Y]
\end{align}
\]</span></p>
<p>That is, <em>no relationship between two random variables implies no linear relationship them.</em> However, the opposite is not true: lack of correlation does <em>not</em> imply independence.</p>
<p><span class="math display">\[
X \perp Y \longrightarrow \text{Cov}[X, Y] = 0
\]</span></p>
</section>
<section id="conditional-expectations" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="conditional-expectations"><span class="header-section-number">5.2</span> Conditional Expectations</h2>
<p>Conditional expectations allow us to describe how the “center” of one random variable’s distribution changes once we condition on the observed value of another random variable.</p>
<ul>
<li>Discrete case (<span class="math inline">\(\forall x \in \textsf{supp}[X]\)</span>)</li>
</ul>
<p><span class="math display">\[
E[Y \mid X = x] = \sum_y y f_{Y \mid X}(y \mid x)
\]</span></p>
<ul>
<li>Continuous case (<span class="math inline">\(\forall x \in \textsf{supp}[X]\)</span>)</li>
</ul>
<p><span class="math display">\[
E[Y \mid X = x] = \int_{-\infty}^\infty y f_{Y \mid X}(y \mid x)dy
\]</span></p>
<p>Note that LOTUS can also be applied to conditional expectations of functions of many random variables.</p>
<p><span class="math display">\[
E[g(X, Y) \mid X = x] = \int_{-\infty}^\infty g(x, y) f_{Y \mid X}(y \mid x)dy
\]</span></p>
<p>Unlike unconditional expectations, <span class="math inline">\(E[Y \mid X = x]\)</span> is a <em>family of operators</em> on the random vector <span class="math inline">\((X, Y)\)</span> that is indexed by <span class="math inline">\(x\)</span>.</p>
<p>A <strong>conditional expectation function</strong> (CEF) is just a conditional expectation takes is sometimes denoted by <span class="math inline">\(G_Y(x)\)</span> to emphasize the fact that it’s a <em>function</em> that maps <span class="math inline">\(x\)</span> to <span class="math inline">\(E[Y \mid X = x]\)</span> rather than the value of <span class="math inline">\(E[Y \mid X = x]\)</span> at some particular <span class="math inline">\(x\)</span>. This notation also emphasizes the fact that it’s a function of <span class="math inline">\(x\)</span>, not a function of the random variable <span class="math inline">\(Y\)</span>.</p>
<p>We write <span class="math inline">\(E[X \mid Y]\)</span> to denote <span class="math inline">\(G_Y(X)\)</span> which is a function of the random variable of <span class="math inline">\(X\)</span>, and thus it’s also a random variable.</p>
<p>The CEF is closely linked to various topics such as <em>regression</em>, <em>missing data</em>, and <em>causal inference</em>.</p>
<ul>
<li><p><strong>Law of total expectations</strong> (also known as the law of iterated expectations or Adam’s law).</p>
<p><span class="math display">\[E[Y] = E\big[E[Y \mid X]\big]\]</span></p>
<p>It implies that the unconditional expectation can be represented as a weighted average of conditional expectations, where the weights are proportional to the probability distribution of the variable being conditioned on.</p>
<p><em>Proof</em></p></li>
</ul>
<p><span class="math display">\[
\begin{align}
E[Y] &amp;= \sum_y y f_Y(y) \\\\ &amp;=
\sum_y y \sum_x f_{X, Y}(x, y) \\\\ &amp;=
\sum_x \sum_y y f_{X \mid Y}(y \mid x) f_X(x) \\\\ &amp;=
\underbrace{\sum_x \overbrace{\bigg(\sum_y y f_{Y \mid X} (y \mid x)\bigg)}^{E[Y \mid X = x]} f_X (x)}_{E\big[E[Y \mid X]\big]}
\end{align}
\]</span></p>
<ul>
<li><p><strong>Law of total variance</strong> (also known as Eve’s law).</p>
<p><span class="math display">\[V[Y] = \underbrace{E\big[V[Y \mid X]\big]}_\text{within-group variation} + \underbrace{V\big[E[Y \mid X]\big]}_\text{between-group variation}\]</span></p>
<p>This theorem allows us to decompose the variability of a random variable <span class="math inline">\(Y\)</span> into the average variability “within” values of <span class="math inline">\(X\)</span> and the variability “across” values of <span class="math inline">\(X\)</span>.</p>
<p>The ordering of the <span class="math inline">\(E\)</span>’s and <span class="math inline">\(V\)</span>’s spells out <span class="math inline">\(EVVE\)</span>, hence the name “Eve’s law”.</p>
<p><em>Proof</em>.</p>
<ol type="1">
<li><p><span class="math inline">\(E[Y] = E\big[E[Y \mid X]\big] = E[G_Y(X)]\)</span> (Adam’s law)</p></li>
<li><p><span class="math inline">\(E \big[V[Y \mid X]\big] = E\big[E[Y^2 \mid X] - G_Y(X)^2\big] = E\big[Y^2\big] - E\big[G_Y(X)^2\big]\)</span></p></li>
<li><p><span class="math inline">\(V[E[Y \mid X]] = E\big[G_Y(X)^2\big] - E[G_Y(X)]^2 = E\big[G_Y(X)^2\big] - E[Y]^2\)</span></p></li>
</ol>
<p>We add (2) and (3) to get back to the original definition of <span class="math inline">\(V[Y] = E\big[Y^2\big] - E[Y]^2\)</span>.</p></li>
</ul>
<p>We can also look at Eve’s law from a different perspective:</p>
<ul>
<li>“Another way to think about Eve’s law is in terms of <em>prediction</em>. If we wanted to predict someone’s height (<span class="math inline">\(Y\)</span>) based on their age (<span class="math inline">\(X\)</span>) alone, the ideal scenario would be if everyone within an age group had exactly the same height, while different age groups had different heights. Then, given someone’s age, we would be able to predict their height perfectly. In other words, the ideal scenario for prediction is <em>no</em> within-group variation in height, since the within-group variation cannot be explained by age differences. For this reason, within-group variation is also called <em>unexplained variation</em>, and between-group variation is also called <em>explained variation</em>. Eve’s law says that the total variance of <span class="math inline">\(Y\)</span> is the sum of unexplained and explained variation” (Blitzstein &amp; Hwang 2014).</li>
</ul>
</section>
<section id="best-predictors" class="level2 page-columns page-full" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="best-predictors"><span class="header-section-number">5.3</span> Best Predictors</h2>
<p>Suppose we knew the full joint cumulative distribution function (CDF) of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and then someone gave us a randomly drawn value of <span class="math inline">\(X\)</span>. What would be the guess of <span class="math inline">\(Y\)</span> that would have the lowest MSE? The function <span class="math inline">\(g(X)\)</span> that best approximates <span class="math inline">\(Y\)</span> is the CEF.</p>
<ul>
<li><span class="math inline">\(E[Y|X]\)</span>, is the best (minimum MSE) predictor of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span>.</li>
</ul>
<p>This makes the CEF a natural target of inquiry: if the CEF is known, much is known about how <span class="math inline">\(X\)</span> relates to <span class="math inline">\(Y\)</span>. But in many cases the CEF can turn out to be an extremely complicated function.</p>
<p>What if we were to restrict ourselves to just <em>linear functions</em> of the form <span class="math inline">\(g_Y(x) = a + b X\)</span>? We could then define the <strong>best linear predictor</strong> (BLP) of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> as the set of values <span class="math inline">\((a, b)\)</span> that minimizes the MSE.</p>
<p>The BLP is expressed as:</p>
<p><span class="math display">\[
(\alpha, \beta) = \underset{a, b \in \mathbb R}{\arg \min}\ E\big[(Y - a + b X)^2\big]
\]</span></p>
<p>Using some calculus, one can show that these values are:</p>
<p><span class="math display">\[
\begin{align}
&amp;\alpha = E[Y] - \frac{\text{Cov}[X, Y]}{V[X]} E[X] \\\\
&amp;\beta =  \frac{\text{Cov}[X, Y]}{V[X]}
\end{align}
\]</span></p>
<p><strong>Note.</strong> This expression is identical to the one provided by the method of <em>ordinary least squares</em> (OLS), which is designed to estimate population parameters from sample data.</p>
<p>There are two important corollaries that follow from this:</p>
<ol type="1">
<li>The BLP is also the best linear approximation of the CEF.</li>
</ol>
<p><span class="math display">\[
(\alpha, \beta) = \underset{a, b \in \mathbb R}{\arg \min}\ E\bigg[\big(E[Y \mid X] - (a + b X)\big)^2\bigg]
\]</span></p>
<ol start="2" type="1">
<li>If the CEF is linear, then the CEF <em>is</em> the BLP.</li>
</ol>
<p>Note that these are some of the implications of <strong>independence</strong> for conditional expectations:</p>
<p><span class="math display">\[
\begin{align}
Y \perp X \iff &amp;1.\ E[Y \mid X] = E[Y] \\\\ &amp;2. V[Y \mid X] = V[Y] \\\\ &amp;3. \text{ The BLP of } Y \text{ given } X \text{ is } E[Y]
\end{align}
\]</span></p>
<p><strong>Plotting the CEF and BLP</strong></p>
<p>Suppose we have the following random variables and that we are interested in approximating the CEF <span class="math inline">\(G_Y(x)\)</span> with it’s BLP.</p>
<p><span class="math display">\[
\begin{align}
&amp;X \sim \text{uniform}(0, 1) \\\\
&amp;W \sim \text{normal}(0, 1) \\\\
&amp;Y = 10X^2 + W
\end{align}
\]</span></p>
<p>By linearity of expectations, can conclude that the CEF is just</p>
<p><span class="math display">\[
E[Y \mid X] =  10 X^2
\]</span></p>
<p>And that the BLP (after some algebra) is given by</p>
<p><span class="math display">\[
\begin{align}
&amp;\beta = \frac{10 \big(E\big[X^3\big] - E[X]E\big[X^2\big]\big)}{E\big[X^2\big] - E[X]^2} \\\\
&amp;\alpha = E[10X^2 + W] - \beta E[X]
\end{align}
\]</span></p>
<p>The final solution is given by integrating over <span class="math inline">\(X \sim \text{uniform}(0, 1)\)</span>:</p>
<p><span class="math display">\[
(\alpha, \beta) = \left(-\frac{5}{3}, 10\right)
\]</span></p>
<p>And plotting both functions over <span class="math inline">\(\textsf{supp}[X]\)</span> looks like this:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="cf">function</span>(m) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">integrate</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">f =</span> <span class="cf">function</span>(x) x<span class="sc">^</span>m <span class="sc">*</span> <span class="fu">fX</span>(x), </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper =</span> <span class="cn">Inf</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">$</span>value</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">*</span> (<span class="fu">E</span>(<span class="dv">3</span>) <span class="sc">-</span> <span class="fu">E</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">E</span>(<span class="dv">2</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  denom <span class="ot">&lt;-</span> <span class="fu">E</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="fu">E</span>(<span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(num <span class="sc">/</span> denom)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span> <span class="sc">*</span> <span class="fu">E</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="fu">slope</span>() <span class="sc">*</span> <span class="fu">E</span>(<span class="dv">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>CEF <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>fX <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> CEF, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">intercept</span>() <span class="sc">+</span> <span class="fu">slope</span>()<span class="sc">*</span>x, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"tomato"</span>) <span class="sc">+</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>), </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="prob-sum-dist_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here, the BLP (in red) approximates the CEF (in blue) reasonably well over the domain of <span class="math inline">\(X\)</span>. While this is not always the case, it is very often the case in the social and health sciences. The BLP is thus a good “first approximation” in a very literal sense, in that it is an approximation with a first-order polynomial.</p>
<p>However, when the CEF is not linear, one must take care in interpreting the BLP as equivalent to the CEF. In particular, this may pose a problem when attempting to make inferences where <span class="math inline">\(X\)</span> has <em>low probability mass</em> over some parts of the domain of the CEF. This is because <em>under nonlinearity, the BLP depends on the distribution of</em> <span class="math inline">\(X\)</span>.</p>
<aside>
See <a href="https://acastroaraujo.shinyapps.io/CEF-BLP/"><strong>here</strong></a> for an interactive demonstration.
</aside>
</section>
<section id="properties-of-residuals" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="properties-of-residuals"><span class="header-section-number">5.4</span> Properties of residuals</h2>
<p>We define deviations (or residuals) with the letter <span class="math inline">\(\epsilon\)</span> and note that they have similar properties when considering with respect to either the CEF or the BLP.</p>
<p><strong>Properties of deviations</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption><strong>Properties of deviations</strong></caption>
<colgroup>
<col style="width: 51%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">CEF</th>
<th style="text-align: center;">BLP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\epsilon = Y - E[Y \mid X]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon = Y - (\alpha + \beta X)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(E[\epsilon] = 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E[\epsilon] = 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(E[\epsilon \mid X] = 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E[\epsilon X] = 0\)</span> (independence)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\text{Cov}[\epsilon, g(X)] = 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\text{Cov}[\epsilon, X] = 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(V[\epsilon \mid X] = V[Y \mid X]\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(V[\epsilon] = E\big[V[Y \mid X]\big]\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./prob-random-vars.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random Variables</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rn.html" class="pagination-link">
        <span class="nav-page-text">Generating Random Numbers</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>